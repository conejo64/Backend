import{_ as H,j as J,r as n,k as Q,o as W,F as X,b as c,c as g,d as y,e as s,f as l,g as i,m as C,i as v,t as D,q as Z,s as ee}from"./index.7427913b.js";import{P as te}from"./ProfileService.5b2022fe.js";const d=P=>(Z("data-v-79ff54bd"),P=P(),ee(),P),le={class:"grid"},se={class:"col-12"},oe={key:0,class:"card"},ae={class:"my-2"},ie={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ne=d(()=>s("h5",{class:"m-0"},"Perfiles",-1)),re={class:"block mt-2 md:mt-0 p-input-icon-left"},de=d(()=>s("i",{class:"pi pi-search"},null,-1)),ce=d(()=>s("span",{class:"p-column-title"},"Nombre",-1)),ue=d(()=>s("span",{class:"p-column-title"},"Descripci\xF3n",-1)),pe={class:"flex align-items-center justify-content-center"},me=d(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),ve={key:0},fe={class:"flex align-items-center justify-content-center"},_e=d(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),be={key:0},he={key:1,class:"card"},ge={class:"card p-fluid formgrid grid"},ye={class:"field col-12 md:col-4"},Pe=d(()=>s("label",{for:"name"},"Nombre",-1)),ke={class:"field col-12 md:col-8"},xe=d(()=>s("label",{for:"description"},"Descripci\xF3n",-1)),Ce={class:"col-12"},De={class:"card"},we=d(()=>s("h5",null,"Permisos",-1)),Ve=d(()=>s("hr",null,null,-1)),Se={__name:"List",setup(P){const u=J(),w=n(!0),V=n(!1),T=n(null),m=n([]),f=n(!1),_=n(!1),o={name:n(null),description:n(null)},p=n(null),M=n(null),k=n({}),S=n(!1),b=new te;Q(()=>{q()}),W(()=>{h(),B()});const h=()=>{const a={page:1,pageSize:10,search:""};b.readProfiles(a).then(e=>{T.value=e.data.entities})},B=()=>{b.readPermissions().then(a=>{m.value[0]=a.data.value,m.value[1]=[]}).catch(()=>{u.add({severity:"error",summary:"",detail:"Error loading Permissions",life:3e3})}).finally(()=>{})},I=()=>{w.value=!1,V.value=!0,o.value={},S.value=!1},R=()=>{w.value=!0,V.value=!1,o.value={},S.value=!1},U=()=>{if(S.value=!0,(o.name.value==null||o.name.value=="")&&u.add({severity:"error",summary:"",detail:"Nombre requerido",life:2e3}),m.value[1].length==0){u.add({severity:"error",summary:"",detail:"Debe seleccionar al menos un permiso",life:2e3});return}let a={name:o.name.value,description:o.description.value,profilePermissions:m.value[1]};b.createProfile(a).then(e=>{e.status==200||e.status==201?(u.add({severity:"success",summary:"Created",detail:"Record created successfully!",life:3e3}),close(),h()):u.add({severity:"error",summary:"Deleted",detail:"Error creating record!",life:3e3})}),o.name.value=null,o.ProfileValueNames.value=[]},j=a=>{o.value={...a}},E=a=>{o.value=a,f.value=!0},F=()=>{b.deleteProfile(o.value.id).then(a=>{a.status===200&&u.add({severity:"success",summary:"",detail:"Record deleting",life:3e3})}),f.value=!1,o.value={},h()},$=()=>{_.value=!0},z=()=>{console.log(p.value[0].id),p.value.forEach(a=>{b.deleteProfile(a.id).then(e=>{e.status===200&&u.add({severity:"success",summary:"",detail:"Record deleting",life:3e3})})}),_.value=!1,p.value=null,h()},q=()=>{k.value={global:{value:null,matchMode:X.CONTAINS}}};return(a,e)=>{const K=c("Toast"),r=c("Button"),O=c("Toolbar"),N=c("InputText"),x=c("Column"),Y=c("DataTable"),L=c("Dialog"),A=c("PickList");return g(),y("div",le,[s("div",se,[l(K),w.value?(g(),y("div",oe,[l(O,{class:"mb-4"},{start:i(()=>[s("div",ae,[l(r,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:I}),l(r,{label:"Delete",icon:"pi pi-trash",class:"p-button-danger",onClick:$,disabled:!p.value||!p.value.length},null,8,["disabled"])])]),_:1}),l(Y,{ref_key:"dt",ref:M,value:T.value,selection:p.value,"onUpdate:selection":e[1]||(e[1]=t=>p.value=t),dataKey:"id",paginator:!0,rows:10,filters:k.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Mostrar {first} to {last} of {totalRecords} registros",responsiveLayout:"scroll"},{header:i(()=>[s("div",ie,[ne,s("span",re,[de,l(N,{modelValue:k.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=t=>k.value.global.value=t),placeholder:"Buscar...",onChange:h},null,8,["modelValue"])])])]),default:i(()=>[l(x,{selectionMode:"multiple",headerStyle:"width: 3rem"}),l(x,{field:"name",header:"Name",sortable:!0,headerStyle:"width:30%; min-width:10rem;"},{body:i(t=>[ce,v(" "+D(t.data.name),1)]),_:1}),l(x,{field:"description",header:"Description",sortable:!0,headerStyle:"width:45%; min-width:10rem;"},{body:i(t=>[ue,v(" "+D(t.data.description),1)]),_:1}),l(x,{headerStyle:"min-width:10rem;"},{body:i(t=>[l(r,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:G=>j(t.data)},null,8,["onClick"]),l(r,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:G=>E(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),l(L,{visible:f.value,"onUpdate:visible":e[3]||(e[3]=t=>f.value=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[l(r,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[2]||(e[2]=t=>f.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:F})]),default:i(()=>[s("div",pe,[me,o?(g(),y("span",ve,[v("Desea eliminar el registro "),s("b",null,D(a.catalog.description),1),v("?")])):C("",!0)])]),_:1},8,["visible"]),l(L,{visible:_.value,"onUpdate:visible":e[5]||(e[5]=t=>_.value=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[l(r,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[4]||(e[4]=t=>_.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:z})]),default:i(()=>[s("div",fe,[_e,o?(g(),y("span",be,"Desea eliminar todos los pefiles seleccionados?")):C("",!0)])]),_:1},8,["visible"])])):C("",!0),V.value?(g(),y("div",he,[s("div",ge,[s("div",ye,[Pe,l(N,{id:"name",type:"text",modelValue:o.name.value,"onUpdate:modelValue":e[6]||(e[6]=t=>o.name.value=t)},null,8,["modelValue"])]),s("div",ke,[xe,l(N,{id:"description",type:"text",modelValue:o.description.value,"onUpdate:modelValue":e[7]||(e[7]=t=>o.description.value=t)},null,8,["modelValue"])]),s("div",Ce,[s("div",De,[we,l(A,{modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=t=>m.value=t),listStyle:"height:250px",dataKey:"id"},{sourceheader:i(()=>[v(" Disponibles ")]),targetheader:i(()=>[v(" Seleccionados ")]),item:i(t=>[s("div",null,D(t.item.description),1)]),_:1},8,["modelValue"])])])]),Ve,l(r,{label:"Save",icon:"pi pi-check",class:"p-button-raised mr-2 mb-2",onClick:U}),l(r,{label:"Cancelar",icon:"pi pi-times",class:"p-button-raised p-button-secondary mr-2 mb-2",onClick:R})])):C("",!0)])])}}},Le=H(Se,[["__scopeId","data-v-79ff54bd"]]);export{Le as default};
